import numpy as np
import pandas as pd 
import matplotlib.pyplot as plt
from PLOT_utils import centergrid

lon_arr = np.array([   -180.000,-177.500,-175.000,-172.500,-170.000,-167.500,-165.000,-162.500,  
                       -160.000,-157.500,-155.000,-152.500,-150.000,-147.500,-145.000,-142.500,
                       -140.000,-137.500,-135.000,-132.500,-130.000,-127.500,-125.000,-122.500,
                       -120.000,-117.500,-115.000,-112.500,-110.000,-107.500,-105.000,-102.500,
                       -100.000, -97.500, -95.000, -92.500, -90.000, -87.500, -85.000, -82.500,
                        -80.000, -77.500, -75.000, -72.500, -70.000, -67.500, -65.000, -62.500,
                        -60.000, -57.500, -55.000, -52.500, -50.000, -47.500, -45.000, -42.500,
                        -40.000, -37.500, -35.000, -32.500, -30.000, -27.500, -25.000, -22.500,
                        -20.000, -17.500, -15.000, -12.500, -10.000,  -7.500,  -5.000,  -2.500,
                          0.000,   2.500,   5.000,   7.500,  10.000,  12.500,  15.000,  17.500,
                         20.000,  22.500,  25.000,  27.500,  30.000,  32.500,  35.000,  37.500,
                         40.000,  42.500,  45.000,  47.500,  50.000,  52.500,  55.000,  57.500,
                         60.000,  62.500,  65.000,  67.500,  70.000,  72.500,  75.000,  77.500,
                         80.000,  82.500,  85.000,  87.500,  90.000,  92.500,  95.000,  97.500,
                        100.000, 102.500, 105.000, 107.500, 110.000, 112.500, 115.000, 117.500,
                        120.000, 122.500, 125.000, 127.500, 130.000, 132.500, 135.000, 137.500,
                        140.000, 142.500, 145.000, 147.500, 150.000, 152.500, 155.000, 157.500,
                        160.000, 162.500, 165.000, 167.500, 170.000, 172.500, 175.000, 177.500   ])

lat_arr = np.array([ -89.500, -88.000, -86.000, -84.000, -82.000, -80.000, -78.000, -76.000,
                     -74.000, -72.000, -70.000, -68.000, -66.000, -64.000, -62.000, -60.000,
                     -58.000, -56.000, -54.000, -52.000, -50.000, -48.000, -46.000, -44.000,
                     -42.000, -40.000, -38.000, -36.000, -34.000, -32.000, -30.000, -28.000,
                     -26.000, -24.000, -22.000, -20.000, -18.000, -16.000, -14.000, -12.000,
                     -10.000,  -8.000,  -6.000,  -4.000,  -2.000,   0.000,   2.000,   4.000,
                       6.000,   8.000,  10.000,  12.000,  14.000,  16.000,  18.000,  20.000,
                      22.000,  24.000,  26.000,  28.000,  30.000,  32.000,  34.000,  36.000,
                      38.000,  40.000,  42.000,  44.000,  46.000,  48.000,  50.000,  52.000,
                      54.000,  56.000,  58.000,  60.000,  62.000,  64.000,  66.000,  68.000,
                      70.000,  72.000,  74.000,  76.000,  78.000,  80.000,  82.000,  84.000,
                      86.000,  88.000,  89.500 ] )

def get_data(filename):
    return np.genfromtxt(filename, delimiter=',')
fname = '../dat/present_VERTICAL_rigidity_2x2.5_individ.csv'
cutoff_map = get_data(fname)

xlist = centergrid(lon_arr)
ylist = centergrid(lat_arr)

#import cartopy.crs as ccrs

#ax.stock_img()

#plt.contourf(lon_arr,lat_arr,cutoff_map)

# Basic contour plot
#fig, ax = plt.subplots( subplot_kw={'projection': ccrs.Robinson()})
fig, ax = plt.subplots()
#ax.coastlines()
im = ax.pcolormesh(lon_arr,lat_arr,cutoff_map,vmin=0.0)
CS = ax.contour(lon_arr,lat_arr,cutoff_map,levels=np.arange(int(np.floor(np.nanmax(cutoff_map)))),colors='black')
ax.clabel(CS, CS.levels, inline=True, fontsize=10,colors='black')
plt.colorbar(im)

plt.tight_layout()
plt.show()
